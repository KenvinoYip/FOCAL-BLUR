<!DOCTYPE html>
<html lang="zh-CN">
<head>
   <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#f8f5e6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>Coffee Daily | The Home Barista Lab</title>
    <link rel="stylesheet" href="style.css?v=2.3">
    <link rel="manifest" href="pwa/manifest.json">
    <link rel="apple-touch-icon" href="images/icon-192.png">
</head>
<body>

<header>
    <h1>FOCAL BLUR</h1>
    <div class="subtitle">精准配比 · 实时计算 · 灵感记录</div>
</header>

    <div class="section-title">
        <div class="section-left">
            <span class="section-item" id="homeTab">首页</span>
            <span class="section-item" id="userBtn">我的</span>
            <span class="section-item" id="addCustomBtn">添加特调</span>
        </div>
    </div>
<div class="main-container" id="mainContainer">
    <aside class="sidebar" id="sidebar">
        <!-- Home View Tabs -->
        <div class="sidebar-item active" id="allTab">Coffee Daily</div>
        <div class="sidebar-item" id="liquorTab">Liquor Daily</div>
        <!-- User View Tabs (Hidden by default) -->
        <div class="sidebar-item" id="customTab" style="display:none;">我的特调</div>
        <div class="sidebar-item" id="favTab" style="display:none;">收藏</div>
    </aside>
    <main class="menu-grid" id="menuGrid"></main>
</div>



<!-- 配方弹窗：遮罩 + 卡片容器 -->
<div class="modal-overlay" id="modalOverlay">
        <div class="recipe-card">
        <!-- 弹窗滚动容器（标题固定、内容可滚动） -->
        <div class="recipe-content-scroll">
            <!-- 标题区：返回键与标题同一行，位置由 CSS 绝对定位控制 -->
            <div class="recipe-header">
                <!-- 标题区：返回键与标题同一行显示，返回键位置由 CSS 绝对定位控制，不影响标题与描述的左对齐 -->
                <h2 class="recipe-title" id="rTitle"><span class="back-btn" id="backBtn"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15 6l-6 6 6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></span><span id="rTitleText">Coffee Name</span></h2>
                <p class="recipe-desc" id="rDesc">Description</p>
                <button class="ellipsis-btn" id="editDotsBtn" aria-label="编辑">
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <circle cx="6" cy="12" r="2"></circle>
                        <circle cx="12" cy="12" r="2"></circle>
                        <circle cx="18" cy="12" r="2"></circle>
                    </svg>
                </button>
                <!-- 三点编辑按钮：
                     - 采用绝对定位固定在标题区域右侧；
                     - 垂直位置由 JS `positionEditDots()` 计算以对齐描述首行；
                     - 点击行为与“编辑步骤”一致，仅影响步骤编辑逻辑，不改变其他视觉与功能。 -->
                <span class="back-btn custom-back-btn" id="customBackBtn" style="display:none;"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15 6l-6 6 6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></span>
                <div id="customInputs" style="display:none; margin-top:10px;">
                    <input id="inputTitle" class="step-input" placeholder="饮品名称">
                    <textarea id="inputDesc" class="step-input" placeholder="描述" rows="3" style="margin-top:8px;"></textarea>
                </div>
            </div>

            <div class="recipe-body">
                <div class="image-container">
                    <img id="rImage" class="recipe-image" alt="">
                <!-- 自定义配方上传覆盖层：无图片时显示 + 上传入口 -->
                <div class="image-add-overlay" id="imageAddOverlay" style="display:none;">
                        <div class="upload-tile" id="overlayUploadTile"><span class="plus">+</span></div>
                        <div class="upload-choices" id="overlayUploadChoices" style="display:none; margin-top:8px;">
                            <button id="overlayChooseGallery" class="small-btn">从相册</button>
                            <button id="overlayChooseCamera" class="small-btn">拍照</button>
                        </div>
                        <input type="file" id="overlayInputImage" accept="image/*" style="display:none;"/>
                        <input type="file" id="overlayInputImageCamera" accept="image/*" capture="environment" style="display:none;"/>
                    </div>
                </div>

                

                <!-- 制作步骤区域：支持编辑/恢复默认/添加步骤 -->
                <div class="steps-block">
                    <div class="steps-bar">
                        <span class="ratio-label">制作步骤</span>
                        <div class="steps-actions">
                            <button id="editStepsBtn" class="small-btn">编辑步骤</button>
                            <button id="resetStepsBtn" class="small-btn">恢复默认</button>
                            <button id="addStepBtn" class="small-btn" style="display:none;">添加步骤</button>
                        </div>
                    </div>
                    <ol id="rSteps"></ol>
                </div>

                <div id="rTipsSection" style="display:none; margin-top:14px;">
                    <span class="ratio-label">Tips</span>
                    <ul id="rTipsList"></ul>
                </div>

                
            </div>
        </div>
        <div class="recipe-footer"><!-- 固定在弹窗底部的区域容器，不随内容滚动 -->
            <button class="save-btn" id="saveBtn"><!-- 保存按钮移至底部区域，保持固定显示 -->
                <span>保存配方</span>
            </button>
        </div>
    </div>
</div>

<div class="image-preview-overlay" id="imagePreviewOverlay" style="display:none;">
    <button class="image-preview-close" id="imagePreviewClose" aria-label="关闭">×</button>
    <img id="imagePreviewImg" alt="">
</div>

<div id="toast" aria-live="polite"></div>
<!-- 提示保存方式：覆盖原有版本或新建配方 -->
<div class="modal-overlay" id="confirmOverlay">
    <div class="confirm-card">
        <div class="confirm-title">检测到步骤变更</div>
        <div class="confirm-actions">
            <button id="overwriteBtn" class="small-btn">覆盖原有版本</button>
            <button id="duplicateBtn" class="small-btn">新建配方</button>
            <button id="cancelChangesBtn" class="small-btn">取消</button>
        </div>
    </div>
</div>
<script src="coffee-data.js"></script>
<script src="liquor-data.js"></script>
<script src="main.js?v=2.3"></script>

<script src="pwa/pwa-prompt.js"></script>
</body>
</html>
